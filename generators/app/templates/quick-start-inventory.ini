#
# This file was autogenerated by `yo living-atlas`.
#
# Please do not edit this file directly so you can rerun new versions of the
# generator in the future including new functionalities and bugfixes.
# See: https://github.com/living-atlases/generator-living-atlas#rerunning-the-generator
#
# Edit your local-extra.ini file instead that has precedence over this.
#

<%_ for (var [group, servers] of Object.entries(LA_groups_and_servers)) {_%>
[<%= group %>]
<%_ for(var i=0; i < servers.length; i++) {
    extravars = group === 'zookeeper'? ` zookeeper_myid=${parseInt(i)+1}`:'';
    extravars = group === 'solrcloud'? ` solr_host=${servers[i]}${extravars}`:extravars;
_%>
<%= servers[i] + extravars %>
<%_ } %>
<%_ } _%>
<%_ for (var [parent, childgroup] of Object.entries(LA_groups_children)) { _%>
[<%= parent %>:children]
<%_ for (var [child, servers] of Object.entries(childgroup)) { _%>
<%= child %>
<%_ } %>
<%_ } _%>
<%_ for (var [parent, childgroup] of Object.entries(LA_groups_children)) { _%>
<%_ for (var [child, servers] of Object.entries(childgroup)) { _%>
[<%= child %>]
<%_ for(var i=0; i < servers.length; i++) { _%>
<%= servers[i] %>
<%_ } %>
<%_ } _%>
<%_ } _%>
[all:vars]

#### all:vars section (common variables for all playbooks/roles)

ansible_user=<% if (typeof LA_variable_ansible_user != 'undefined') { %><%- LA_variable_ansible_user %><% } else { %>ubuntu<% } %>
ansible_become=yes
is_vagrant=false
# Mounted storage is usually /mnt on EC2. Create a symlink to /mnt -> /data
data_dir=/data

skin_home_url = <%= LA_urls_prefix %><%= LA_domain %>

## EMAILS

technical_contact = <% if (typeof LA_variable_support_email != 'undefined') { %><%- LA_variable_support_email %><% } else { %>support@<%= LA_domain %><% } %>
orgSupportEmail= <% if (typeof LA_variable_support_email != 'undefined') { %><%- LA_variable_support_email %><% } else { %>support@<%= LA_domain %><% } %>
download_support_email= <% if (typeof LA_variable_support_email != 'undefined') { %><%- LA_variable_support_email %><% } else { %>support@<%= LA_domain %><% } %>
email_sender= <% if (typeof LA_variable_support_email != 'undefined') { %><%- LA_variable_support_email %><% } else { %>support@<%= LA_domain %><% } %>
support_email= <% if (typeof LA_variable_support_email != 'undefined') { %><%- LA_variable_support_email %><% } else { %>support@<%= LA_domain %><% } %>
swagger_contact_email= <% if (typeof LA_variable_support_email != 'undefined') { %><%- LA_variable_support_email %><% } else { %>support@<%= LA_domain %><% } %>
orgEmail= <% if (typeof LA_variable_orgEmail != 'undefined') { %><%- LA_variable_orgEmail %><% } else { %>info@<%= LA_domain %><% } %>
eml_email_address = <% if (typeof LA_variable_support_email != 'undefined') { %><%- LA_variable_support_email %><% } else { %>support@<%= LA_domain %><% } %>

############# GBIF Name matching index

<%_ if (LA_use_namematching_service) { _%>
namematching_service_url = <%= LA_urls_prefix %><%= LA_namematching_service_url %><%= LA_namematching_service_path %>
<%_ } _%>
custom_namematching_url = https://datos.gbif.es/others/nameindex-gbif-backbone-2021-11-26-lucene-6.tgz
nameindex_to_use = custom
nameindex_datestamp = gbif-2021-nov-lucene-6
nameindex_checksum = sha1:74cea2301134411e962ca4857c7ebfce0ff8c9c8

# GBIF DwCA for bie-index
namedata_to_use = custom
custom_namedata_repo = https://datos.gbif.es/namedata
custom_name_sources = "[ { 'name': 'gbif-backbone', 'checksum': 'sha1:fa4f3f355ff5cd9e5062ae238cdc4bd94daeea90', 'datestamp': '2021-11-26' } ]"

####################### Biocache ##############################################

biocache_db_host = <%= LA_biocache_backend_hostname %>
biocache_db_type = cassandra3
biocache_db_port = 9042
cassandra_listen_host = <%= LA_biocache_backend_hostname %>
use_cassandra3 = true
biocache_service_hostname = <%= LA_biocache_service_url %>
biocache_service_url = <%= LA_urls_prefix %><%= LA_biocache_service_url %><%= LA_biocache_service_path %>
biocache_service_base_url = <%= LA_urls_prefix %><%= LA_biocache_service_url %>
biocache_service_context_path = <%= LA_biocache_service_path %>
logging_enabled = true
default_country =
<%_ if (LA_use_spatial) { _%>
layers_service_url=<%= LA_urls_prefix %><%= LA_spatial_url %>/ws
spatial_layers_url=<%= LA_urls_prefix %><%= LA_spatial_url %>/ws/fields
<%_ } else { _%>
# While you decide to enable and deploy the spatial service we use ALA service to avoid issues
layers_service_url=https://spatial.ala.org.au/ws
spatial_layers_url=https://spatial.ala.org.au/ws/fields
<%_ } _%>
layers_service_sampling = <%= LA_use_spatial %>
enable_lists = <%= LA_use_species_lists %>
include_species_lists = <%= LA_use_species_lists %>
<%_ if (LA_use_species_lists) { _%>
lists_service_url = <%= LA_urls_prefix %><%= LA_lists_url %><%= LA_lists_path %>
specieslist_apikey_check_url = <%= LA_urls_prefix %><%= LA_cas_url %>/apikey/ws/check?apikey=
<%_ } _%>
commonname_lang = en
media_store_local = <%= !LA_use_images %>
<%_ if (LA_use_images) { _%>
media_store_url=<%= LA_urls_prefix %><%= LA_images_url %><%= LA_images_path %>
<%_ } _%>
download_url=<%= LA_urls_prefix %><%= LA_biocache_service_url %><%= LA_biocache_service_path %>/biocache-download
download_dir=/data/biocache-download
<%_ if (LA_use_spatial) { _%>
geoserver_url=<%= LA_urls_prefix %><%= LA_spatial_url %>/geoserver
<%_ } else { _%>
# While you decide to enable and deploy the spatial service we use ALA service to avoid issues
geoserver_url=https://spatial.ala.org.au/geoserver
<%_ } _%>
sightings_base_url=

####################### Hub ###################################################

biocache_hub_hostname = <%= LA_ala_hub_url %>
biocache_hub_url = <%= LA_urls_prefix %><%= LA_ala_hub_url %><%= LA_ala_hub_path %>
biocache_hub_base_url = <%= LA_urls_prefix %><%= LA_ala_hub_url %>
biocache_hub_context_path = <%= LA_ala_hub_path %>
# Used by Image service
biocache_url = <%= LA_urls_prefix %><%= LA_ala_hub_url %><%= LA_ala_hub_path %>
# Used by regions, userdetails, apikey, lists, ...
biocache_base_url = <%= LA_urls_prefix %><%= LA_ala_hub_url %><%= LA_ala_hub_path %>
biocache_hub_artifact = ala-hub
biocache_hub_skin_layout = ala

userdetails_url = <%= LA_urls_prefix %><%= LA_cas_url %>/userdetails/userDetails/

userdetails_base_url = <%= LA_urls_prefix %><%= LA_cas_url %>
# In alerts this is with slash '/userdetails' not in the rest
userdetails_context_path = userdetails

# By default caches are disabled (the collections cache is problematic when collectory + biocache on same server)
# Configure properly for your case

caches_auth_enabled=<% if (typeof LA_variable_caches_auth_enabled != 'undefined') { %><%- LA_variable_caches_auth_enabled %><% } else { %>false<%_ } %>
caches_log_enabled=<% if (typeof LA_variable_caches_logs_enabled != 'undefined') { %><%- LA_variable_caches_logs_enabled %><% } else { %>false<%_ } %>
# If collections cache is disabled biocache-service will show collections_uid, institutions_uid instead of their respective names in facets and legends
caches_collections_enabled=<% if (typeof LA_variable_caches_collections_enabled != 'undefined') { %><%- LA_variable_caches_collections_enabled %><% } else { %>false<%_ } %>
caches_layers_enabled=<% if (typeof LA_variable_caches_layers_enabled != 'undefined') { %><%- LA_variable_caches_layers_enabled %><% } else { %>false<%_ } %>

org_url = <%= LA_urls_prefix %><%= LA_domain %>

skin_orgNameLong = <%= LA_project_name %>
orgNameLong = <%= LA_project_name %>
orgNameShort = <%= LA_project_shortname %>

explore_your_area_lat = <% if (typeof LA_collectory_map_centreMapLat != 'undefined') { %><%- LA_collectory_map_centreMapLat %><% } else { %>16.942<%_ } %>
explore_your_area_lng = <% if (typeof LA_collectory_map_centreMapLng != 'undefined') { %><%- LA_collectory_map_centreMapLng %><% } else { _%>1.261<%_ } %>
explore_your_area_location = <% if (typeof LA_variable_map_zone_name != 'undefined') { %><%- LA_variable_map_zone_name %><% } else { %>Australia<%_ } %>

map_default_latitude = <% if (typeof LA_collectory_map_centreMapLat != 'undefined') { %><%- LA_collectory_map_centreMapLat %><% } else { %>16.942<%_ } %>
map_default_longitude = <% if (typeof LA_collectory_map_centreMapLng != 'undefined') { %><%- LA_collectory_map_centreMapLng %><% } else { _%>1.261<%_ } %>
map_default_zoom = 5

# Used in bie
default_map_lat = <% if (typeof LA_collectory_map_centreMapLat != 'undefined') { %><%- LA_collectory_map_centreMapLat %><% } else { %>16.942<%_ } %>
default_map_lon = <% if (typeof LA_collectory_map_centreMapLng != 'undefined') { %><%- LA_collectory_map_centreMapLng %><% } else { _%>1.261<%_ } %>

# If you don't want fluid layout, leave this option empty
skin_fluid_layout = true

use_ala_image_service = <%= LA_use_images %>
<%_ if (LA_use_images) { _%>
image_service_viewer_url = <%= LA_urls_prefix %><%= LA_images_url %><%= LA_images_path %>/image/viewer?imageId=
image_service_metadata_url = <%= LA_urls_prefix %><%= LA_images_url %><%= LA_images_path %>/image/details?imageId=
alwaysshow_imagetab = true
<%_ } _%>

use_download_plugin=true
downloads_indexed_download_url=<%= LA_urls_prefix %><%= LA_biocache_service_url %><%= LA_biocache_service_path %>/occurrences/offline/download
downloads_checklist_download_url=<%= LA_urls_prefix %><%= LA_biocache_service_url %><%= LA_biocache_service_path %>/occurrences/facets/download
downloads_indexed_fields_url=<%= LA_urls_prefix %><%= LA_biocache_service_url %><%= LA_biocache_service_path %>/index/fields
downloads_fieldguide_download_url =
downloads_static_downloads_url =

downloads_terms_of_use= <% if (typeof LA_variable_downloads_terms_of_use != 'undefined') { %><%- LA_variable_downloads_terms_of_use %><% } else { %><% } %>
swagger_info_terms_of_services= <% if (typeof LA_variable_downloads_terms_of_use != 'undefined') { %><%- LA_variable_downloads_terms_of_use %><% } else { %><% } %>
download_auth_sensitive = true
download_solr_only = true

privacy_policy_url= <% if (typeof LA_variable_privacy_policy_url != 'undefined') { %><%- LA_variable_privacy_policy_url %><% } else { %><% } %>

grouped_facets_json=grouped_facets_default.json
biocache_grouped_facets_url=file:///data/ala-hub/config/grouped_facets_default.json

####################### Collectory ############################################

collectory_hostname = <%= LA_collectory_url %>
collectory_url = <%= LA_urls_prefix %><%= LA_collectory_url %><%= LA_collectory_path %>
collectory_service_url = <%= LA_urls_prefix %><%= LA_collectory_url %><%= LA_collectory_path %>/ws
collectory_base_url = <%= LA_urls_prefix %><%= LA_collectory_url %>
collectory_context_path = <%= LA_collectory_path %>
collectory_db_host_address = localhost
collectory_db_host = localhost
collectory_db_user = collectory
bypass_cas = <%= !LA_use_CAS %>

# Used by collectory
apikey_service_url=https://<%= LA_cas_url %>/apikey/ws/check?apikey=
# Used by biocache
api_check_url=https://<%= LA_cas_url %>/apikey/ws/check?apikey=
# Used by profile service
apikey_check_url=https://<%= LA_cas_url %>/apikey/ws/check?apikey=
public_archive_url=<%= LA_urls_prefix %><%= LA_ala_hub_url %><%= LA_ala_hub_path %>/archives/gbif/@UID@/@UID@.zip
gbif_archive_url=<%= LA_urls_prefix %><%= LA_ala_hub_url %><%= LA_ala_hub_path %>/archives/gbif/@UID@/@UID@.zip

orgNameLong = <%= LA_project_name %>
orgNameShort = <%= LA_project_shortname %>

####################### CAS Auth system #######################################

# Security bypass
security_bypass = <%= !LA_use_CAS %>

# Skinning
skin = ala

# Map config
collections_map_lat = <% if (typeof LA_collectory_map_centreMapLat != 'undefined') { %><%- LA_collectory_map_centreMapLat %><% } else { %>16.942<%_ } %>
collections_map_lon = <% if (typeof LA_collectory_map_centreMapLng != 'undefined') { %><%- LA_collectory_map_centreMapLng %><% } else { _%>1.261<%_ } %>
collections_map_zoom = 3

# Project name
orgNameShort = <%= LA_project_shortname %>
orgNameLong = <%= LA_project_name %>
orgCity = <% if (typeof LA_variable_orgCity != 'undefined') { %><%- LA_variable_orgCity %><% } else { %>Camberra<%_ } %>
orgStateProvince = <% if (typeof LA_variable_orgStateProvince != 'undefined') { %><%- LA_variable_orgStateProvince %><% } else { %>ACT<%_ } %>
orgPostcode = <% if (typeof LA_variable_orgPostcode != 'undefined') { %><%- LA_variable_orgPostcode %><% } else { %>2601<%_ } %>
orgCountry = <% if (typeof LA_variable_orgCountry != 'undefined') { %><%- LA_variable_orgCountry %><% } else { %>Australia<%_ } %>

region = <% if (typeof LA_variable_map_zone_name != 'undefined') { %><%- LA_variable_map_zone_name %><% } else { %>Australia<%_ } %>
regionName = <% if (typeof LA_variable_map_zone_name != 'undefined') { %><%- LA_variable_map_zone_name %><% } else { %>Australia<%_ } %>

# EML config
eml_delivery_point = <% if (typeof LA_variable_orgAddress != 'undefined') { %><%- LA_variable_orgAddress %><% } else { %>Clunies Ross Street<%_ } %>
eml_city = <% if (typeof LA_variable_orgCity != 'undefined') { %><%- LA_variable_orgCity %><% } else { %>Camberra<%_ } %>
eml_admin_area = <% if (typeof LA_variable_orgStateProvince != 'undefined') { %><%- LA_variable_orgStateProvince %><% } else { %>ACT<%_ } %>
eml_postal_code = <% if (typeof LA_variable_orgPostcode != 'undefined') { %><%- LA_variable_orgPostcode %><% } else { %>2601<%_ } %>
eml_country = <% if (typeof LA_variable_orgCountry != 'undefined') { %><%- LA_variable_orgCountry %><% } else { %>Australia<%_ } %>

# Disable UI components
disable_map = false
disable_alerts = <%= !LA_use_alerts %>
myannotation.enabled = <%= LA_use_alerts %>
disable_logger = false

# GBIF base URL for webservices
# For testing purposes use: https://api.gbif-uat.org/v1/
gbif_api_url = https://api.gbif.org/v1/

# Logger URL
logger_webservice_url = <%= LA_urls_prefix %><%= LA_logger_url %><%= LA_logger_path %>/service

# Species list tool
<% if (LA_use_species_lists) { %>
species_list_tool_url = <%= LA_urls_prefix %><%= LA_lists_url %><%= LA_lists_path %>/speciesListItem/list/
<% } %>

####################### SOLR STANDALONE #######################
# Used by BIE and/or biocache-store
solr_url = http://<%= LA_solr_url %>:8983/solr/biocache
solr_base_url = http://<%= LA_solr_url %>:8983
solr_context_path = <%= LA_solr_path %>
# Solr will start listing to this name/address, so it should be in the VM or
# 'I cannot bind' error will raise. Also you have to allow this IP/port in your
# internal LAN addresses
solr_host = <%= LA_solr_url %>
solr_port = 8983
# solr_version is configured previously
#  solr_version=

# Deprecated: Used only in solr4 old role
solr_hostname = <%= LA_solr_hostname %>

# FIXME: Adjust this to your needs
solr_heap = 8g

sandbox_hostname = <%= LA_domain %>
sandbox_url = <%= LA_urls_prefix %><%= LA_domain %>/sandbox
sandbox_base_url = <%= LA_urls_prefix %><%= LA_domain %>
sandbox_context_path = /sandbox

################# Logger Service ############

logger_hostname = <%= LA_logger_url %>
logger_url = <%= LA_urls_prefix %><%= LA_logger_url %><%= LA_logger_path %>
logger_base_url = <%= LA_urls_prefix %><%= LA_logger_url %>
logger_context_path = <%= LA_logger_path %>
logger_db_name = logger
logger_db_username = logger_user
logger_db_hostname = localhost
logger_authorize_ip_list = <% if (typeof LA_server_ips != 'undefined') { %><%- LA_server_ips %><% } else { %><%_ } %>

############### Auth Server #########

auth_base_url = <%= LA_urls_prefix %><%= LA_cas_url %>
auth_cas_url = <%= LA_urls_prefix %><%= LA_cas_url %>/cas

####### When near the GBIF building (e.g. in Europe) the GBIF nexus will likely be fastest #########

use_gbif_nexus = false

####### SDS common vars #######

sds_enabled = <%= LA_use_sds %>
<%_ if (LA_use_sds) { _%>
biocache_sds_url = <%= LA_urls_prefix %><%= LA_sds_url %><%= LA_sds_path %>
sds_faq_url = <% if (typeof LA_variable_sds_faq_url != 'undefined') { %><%- LA_variable_sds_faq_url %><% } else { %>https://www.ala.org.au/faq/data-sensitivity/<% } %>
sds_spatial_layers = <% if (typeof LA_variable_sds_spatial_layers != 'undefined') { %><%- LA_variable_sds_spatial_layers %><% } %>
sds_flag_rules = <% if (typeof LA_variable_sds_flag_rules != 'undefined') { %><%- LA_variable_sds_flag_rules %><% } %>

<%_ } else { _%>
biocache_sds_url =
<%_ } _%>

# Disabled caches - the collections cache is problematic when collectory + biocache on same server

caches_auth_enabled=false
caches_log_enabled=false
# If collections cache is disabled biocache-service will show collections_uid, institutions_uid instead of their respective names in facets and legends
caches_collections_enabled=false
caches_layers_enabled=false

webserver_nginx=true
ssl=<%= LA_enable_ssl %>
force_https=<%= LA_enable_ssl %>
nginx_client_max_body_size=1024m

<%_ if (LA_enable_ssl) { _%>
ssl_certificate_server_dir=/etc/ssl
ssl_cert_file=certs/ssl-cert-snakeoil.pem
ssl_key_file=private/ssl-cert-snakeoil.key
<%_ } _%>

# nginx_vhost_fragments_to_clear = <%- JSON.stringify(LA_nginx_vhosts)%>
nginx_vhost_fragments_to_clear =
# https://github.com/AtlasOfLivingAustralia/documentation/wiki/Troubleshooting#nginx-vhost-ansible-issues
nginx_vhost_fragments_to_clear_no_warning = true

# This prevents overwrite vhost configurations when deploying in same server
# See: https://github.com/AtlasOfLivingAustralia/ala-install/pull/368
# vhost_with_appname_conf = true

############### Biocache CLI options ###############

biocache_opts = -Xmx1g -Xms1g

############## Base header / footer ###############
# NOTE: this header/footer url doesn't have a trailing /
header_and_footer_baseurl = <%= LA_urls_prefix %><% if (typeof LA_branding_url != 'undefined') { %><%- LA_branding_url %><% } else { %><%- LA_domain %><%_ } %><% if (typeof LA_branding_path != 'undefined') { %><%- LA_branding_path.replace(/\/$/, "") %><% } else { %><%_ } %>
header_and_footer_version = 2

###### favicon #######
favicon_url=<% if (typeof LA_variable_favicon_url != 'undefined') { %><%- LA_variable_favicon_url %><% } else { %>https://raw.githubusercontent.com/living-atlases/artwork/master/favicon.ico<% } %>
skin_favicon=<% if (typeof LA_variable_favicon_url != 'undefined') { %><%- LA_variable_favicon_url %><% } else { %>https://raw.githubusercontent.com/living-atlases/artwork/master/favicon.ico<% } %>

<%_ if (LA_use_species_lists) { _%>
######### Species list ##############

specieslist_hostname = <%= LA_lists_url %>
specieslist_url = <%= LA_urls_prefix %><%= LA_lists_url %><%= LA_lists_path %>
specieslist_base_url = <%= LA_urls_prefix %><%= LA_lists_url %>
specieslist_context_path = <%= LA_lists_path %>
specieslist_db_hostname = localhost
specieslist_db_name = specieslists
specieslist_db_username = specieslists
collectory_enable_sync = false
<%_ if (LA_use_species) { _%>
bie_service_base_url = <%= LA_urls_prefix %><%= LA_bie_index_url %><%= LA_bie_index_path %>
<%_ } _%>
field_guide_base_url =
# Used by alerts
species_list_server = <%= LA_urls_prefix %><%= LA_lists_url %><%= LA_lists_path %>

<%_ } else { _%>
# Added while we install our BIE service
specieslist_url = https://lists.ala.org.au
<%_ } _%>

<%_ if (LA_use_species) { _%>
############# BIE index ################

bie_index_base_url = <%= LA_urls_prefix %><%= LA_bie_index_url %>
bie_index_context_path = <%= LA_bie_index_path %>
bie_index_hostname = <%= LA_bie_index_url %>

bie_use_yml = true

index_live_url = http://<%= LA_solr_url %>:8983/solr/bie
index_offline_url = http://<%= LA_solr_url %>:8983/solr/bie-offline

<%_ } else { _%>
# Added while we install our BIE service
bie_base_url = https://bie.ala.org.au
bie_service_base_url = https://bie.ala.org.au/ws
<%_ } _%>

biocache_solr_url = http://<%= LA_solr_url %>:8983/solr/biocache
collectory_url = <%= LA_urls_prefix %><%= LA_collectory_url %><%= LA_collectory_path %>

disable_cas = <%= !LA_use_CAS %>
bypass_cas = <%= !LA_use_CAS %>

index_images = <%= LA_use_images %>

<%_ if (LA_use_species) { _%>
############# BIE Hub ################

bie_hub = ala-bie
bie_hub_base_url = <%= LA_urls_prefix %><%= LA_ala_bie_url %>
bie_hub_context_path = <%= LA_ala_bie_path %>
bie_hub_hostname = <%= LA_ala_bie_url %>
<%_ } _%>
bie_service_enabled = <%= LA_use_species %>
<%_ if (LA_use_species_lists) { _%>
species_list_url = <%= LA_urls_prefix %><%= LA_lists_url %><%= LA_lists_path %>
specieslist_service_url = <%= LA_urls_prefix %><%= LA_lists_url %><%= LA_lists_path %>/ws
lists_base_url = <%= LA_urls_prefix %><%= LA_lists_url %><%= LA_lists_path %>
<%_ } else { _%>
species_list_url = https://lists.ala.org.au
specieslist_service_url = https://lists.ala.org.au
lists_base_url = https://lists.ala.org.au
<%_ } _%>

sightings_url =
<%_ if (LA_use_spatial) { _%>
spatial_url=<%= LA_urls_prefix %><%= LA_spatial_url %>
spatial_base_url=<%= LA_urls_prefix %><%= LA_spatial_url %>
<%_ } else { _%>
# While you decide to enable and deploy the spatial service we use ALA service to avoid issues
spatial_url=https://spatial.ala.org.au
spatial_base_url=https://spatial.ala.org.au
<%_ } _%>

<%_ if (LA_use_species) { _%>
bie_base_url = <%= LA_urls_prefix %><%= LA_ala_bie_url %><%= LA_ala_bie_path %>
skin_taxa_links_base_url = <%= LA_urls_prefix %><%= LA_ala_bie_url %><%= LA_ala_bie_path %>/species/
<%_ } _%>
ala_base_url = <%= LA_urls_prefix %><%= LA_domain %>
ala_baseurl = <%= LA_urls_prefix %><%= LA_domain %>

use_ala_bie=<%= LA_use_species %>
use_ala_spatial_portal=<%= LA_use_spatial %>

# EOL
eol_sanitise=true
eol_html_allowedElements=h1,h2,h3,h4,h5,h6,div,a,br,i,b,u,small,strike,span,ul,li,p,sup,cite,ol,em,hr
eol_html_allowAttributes=href;a;^(http|https|mailto|#).+,class;span,id;span,src;img;^(http|https).+

<%_ if (LA_use_images) { _%>

####### Images #######

image_service_url = <%= LA_urls_prefix %><%= LA_images_url %><%= LA_images_path %>
image_service_base_url = <%= LA_urls_prefix %><%= LA_images_url %>
image_service_context_path = <%= LA_images_path %>
image_service_hostname = <%= LA_images_url %>
image_service_db_name=images
image_service_db_username=images
image_service_port=9101

# Used by bie-index
image_base_url = <%= LA_urls_prefix %><%= LA_images_url %>
<%_ } _%>

<%_ if (LA_use_regions) { _%>

####### Regions #######

regions_hostname = <%= LA_regions_url %>
regions_base_url = <%= LA_urls_prefix %><%= LA_regions_url %>
regions_context_path = <%= LA_regions_path %>
regions_artifact = regions

regions_map_bounds = <% if (typeof LA_regions_map_bounds != 'undefined') { %><%- LA_regions_map_bounds %><% } else { %>[]<%_ } %>
regions_map_height =
<%_ } _%>
<%_ if (LA_use_spatial) { _%>
spatial_base_url=<%= LA_urls_prefix %><%= LA_spatial_url %>
spatial_base_url_ws=<%= LA_urls_prefix %><%= LA_spatial_url %>/ws
geoserver_base_url=<%= LA_urls_prefix %><%= LA_spatial_url %>/geoserver
<%_ } else { _%>
# While you decide to enable and deploy the spatial service we use ALA service
spatial_base_url=https://spatial.ala.org.au
spatial_base_url_ws=https://spatial.ala.org.au/ws
geoserver_base_url=https://spatial.ala.org.au/geoserver
<%_ } _%>

<%_ if (LA_use_alerts) { _%>
alerts_url = <%= LA_urls_prefix %><%= LA_alerts_url %><%= LA_alerts_path %>
alerts_base_url = <%= LA_urls_prefix %><%= LA_alerts_url %>
alerts_context_path = <%= LA_alerts_path %>
alerts_apikey_check_url = <%= LA_urls_prefix %><%= LA_cas_url %>/apikey/ws/check?apikey=
alerts_apikey_whitelist = <% if (typeof LA_server_ips != 'undefined') { %><%- LA_server_ips %><% } else { %><%_ } %>
alerts_hostname = <%= LA_alerts_url %>
alerts_db_hostname = localhost
alerts_db_name = alerts
alerts_db_username = alerts
alerts_myannotation_enabled = true
set_sql_mode=false
email_sender = <% if (typeof LA_variable_support_email != 'undefined') { %><%- LA_variable_support_email %><% } else { %>support@<%= LA_domain %><% } %>
email_alert_address_title = <%= LA_project_shortname %> alerts
email_info_address_title = <%= LA_project_name %>
email_info_sender = <% if (typeof LA_variable_support_email != 'undefined') { %><%- LA_variable_support_email %><% } else { %>support@<%= LA_domain %><% } %>
enable_email = true
occurrence_searchTitle = occurrence search
occurrence_searchUrl = https://biocache.ala.org.au/occurrences/search?q=passer
regions_searchTitle = ACT
regions_searchUrl = https://regions.ala.org.au/states/Australian+Capital+Territory
speciesPages_searchTitle = Shingle-back
speciesPages_searchUrl = https://bie.ala.org.au/species/Tiliqua+rugosa
collection_searchTitle = ANIC
collection_searchUrl = https://collections.ala.org.au/public/show/co13
enable_specieslists_alerts =  <%= LA_use_species_lists %>
enable_spatial_alerts = <%= LA_use_spatial %>
enable_blogs_alerts = false
enable_citizen_science_alerts = false
<%_ } else { _%>
alerts_base_url =
alerts_url =
<%_ } _%>

biocache_records_url=<%= LA_urls_prefix %><%= LA_ala_hub_url %><%= LA_ala_hub_path %>
biocache_service_url = <%= LA_urls_prefix %><%= LA_biocache_service_url %><%= LA_biocache_service_path %>
<%_ if (LA_use_spatial) { _%>
# Used by regions allowedHost
spatial_ws_hostname=<%= LA_spatial_url %>
<%_ } else { _%>
# While you decide to enable and deploy the spatial service we use ALA service
spatial_ws_hostname=spatial.ala.org.au
<%_ } _%>

<%_ if (LA_use_webapi) { _%>
####### Web API #######
webapi_hostname = <%= LA_webapi_url %>
webapi_base_url = <%= LA_urls_prefix %><%= LA_webapi_url %>
webapi_url = <%= LA_urls_prefix %><%= LA_webapi_url %><%= LA_webapi_path %>
webapi_context_path = <%= LA_webapi_path %>
webapi_db_hostname = localhost
webapi_db_name = webapi
webapi_db_username = webapi

<%_ } _%>
<%_ if (LA_use_dashboard) { _%>
####### Dashboard #######
dashboard_hostname = <%= LA_dashboard_url %>
dashboard_base_url = <%= LA_urls_prefix %><%= LA_dashboard_url %>
dashboard_url = <%= LA_urls_prefix %><%= LA_dashboard_url %><%= LA_dashboard_path %>
dashboard_context_path = <%= LA_dashboard_path %>
volunteer_base_url =

<%_ } _%>
##### Copied from workshop, should be in living-atlas inventory

postgresql_username=postgres
postgis_version=9.6
pg_service=postgresql-9.6
pg_version=9.6
postgis_version=2.4
# Needed for installing on Ubuntu-18.04, remove it for Ubuntu 20.4
# https://github.com/AtlasOfLivingAustralia/biocache-service/issues/363
# tomcat=tomcat7
# tomcat_user=tomcat7

# Tune this per service if you need less or more memory on it
tomcat_java_opts = -Xmx4g -Xms4g -Xss256k -Djava.awt.headless=true

##### Updated components versions
#
# Check: https://github.com/AtlasOfLivingAustralia/documentation/wiki/Components-versioning
#

# Default fallback versions (if the toolkit does not set them)

alerts_version = 1.5.3
apikey_version = 1.5
bie_hub_version = 1.5.1
bie_index_version = 1.4.15
biocache_cli_version = 2.6.1
biocache_hub_version = 4.0.8
# Newers versions of biocache-service > 2.4.2 require tomcat8/9
biocache_service_version = 2.7.1
cas_management_version = 5.3.6-1
cas_version = 5.3.12-2
collectory_version = 1.6.4
dashboard_version = 2.2
doi_service_version = 1.1.5
image_service_version = 1.1.7.1
logger_version = 3.0.0
ala_name_matching_version = 3.5
regions_version = 3.3.5
sds_version = 1.6.2
solr_version = 7.7.3
solrcloud_version = 8.9.0
spatial_hub_version = 0.4.2
spatial_service_version = 0.4.2
species_list_version = 3.5.9
user_details_version = 2.3.0
webapi_version = 2.0
pipelines_version = 2.10.0-SNAPSHOT+0~20211207143901.470~1.gbpf64561
data_quality_filter_service_version = 1.0.0
namematching_service_version=1.4

<%_ if (typeof LA_software_versions != 'undefined') { _%>
<%_ if (LA_software_versions.length > 0) { _%>
# Software versions selected in the la-toolkit:
<%_ } %>
<%_ for(var i=0; i < LA_software_versions.length; i++) { _%>
<%= LA_software_versions[i][0] %> = <%= LA_software_versions[i][1] %>
<%_ } %>
<%_ } _%>

<%_ if (LA_use_doi) { _%>
doi_service_url = <%= LA_urls_prefix %><%= LA_doi_url %><%= LA_doi_path %>
doi_service_api_url = <%= LA_urls_prefix %><%= LA_doi_url %><%= LA_doi_path %>/api/
download_doi_resolver = <%= LA_urls_prefix %><%= LA_doi_url %><%= LA_doi_path %>/doi/
my_download_doi_baseUrl = <%= LA_urls_prefix %><%= LA_doi_url %><%= LA_doi_path %>/myDownloads
download_doi_licence_prefix = "Datasets are covered by the following licence(s): "
download_doi_title_prefix = "Occurrence download "
# Enable to use DOI service
doi_mint_doi = false
doi_swagger_info_description=Generate DOIs for <%= LA_project_shortname %> applications
doi_swagger_info_title=<%= LA_project_shortname %> DOI service
<%_ } _%>

#### END of all:vars section

[branding:vars]

branding_hostname = <% if (typeof LA_branding_hostname != 'undefined') { %><%- LA_branding_hostname %><% } else { %><%- LA_main_hostname %><%_ } %>
branding_url = <% if (typeof LA_branding_url != 'undefined') { %><%- LA_branding_url %><% } else { %><%- LA_main_hostname %><%_ } %>
branding_path = <% if (typeof LA_branding_path != 'undefined') { %><%- LA_branding_path %><% } else { %>/<%_ } %>
branding_nginx_cors_origin_regexp = ^https?:\/\/(localhost|<%- LA_domain.replace(/\./g, '\\.') %>|.*\.<%- LA_domain.replace(/\./g, '\\.') %>)

# this general 'nginx_cors_origin_regexp' can fail if you install the branding with other services, so added only to branding above
# nginx_cors_origin_regexp = ^https?:\/\/(localhost|<%- LA_domain.replace(/\./g, '\\.') %>|.*\.<%- LA_domain.replace(/\./g, '\\.') %>)

[nameindexer:vars]

ala_name_matching_version = "3.4"

[biocache-cli:vars]

nameindex_user = root

[collectory:vars]

<%_ if (typeof LA_collectory_version_ge_3 != 'undefined') { _%>
<%_ if (LA_collectory_version_ge_3) { _%>
collectory_app = collectory
collectory_skin_layout = ala-main
collectory_fluid_layout = true
<%_ } else { _%>
collectory_app = ala-collectory
collectory_skin_layout = ala
<%_ } _%>
<%_ } else { _%>
# For versions < 3.0.0
collectory_app = ala-collectory
collectory_skin_layout = ala
# For versions >= 3.0.0
# collectory_app = collectory
# collectory_skin_layout = ala-main
<%_ } _%>

# When https://github.com/AtlasOfLivingAustralia/collectory-plugin/issues/159 is fixed set to true
content_type_options_header=false

# Whether to check API keys for incoming write requests
api_key_check_enabled = <%= LA_use_CAS %>

# RIFCS
rifcs_exclude_bounds = true

[biocache-hub:vars]

skin_layout = ala
# Warning: in biocache, the app uses userdetais_base_url instead of userdetails_url
# https://github.com/AtlasOfLivingAustralia/biocache-hubs/blob/ba944aca8c848c816bf9931b0f21900e3dedfb63/grails-app/services/au/org/ala/biocache/hubs/UserDataService.groovy#L32
# so in the rest of inventories like CAS, we use the correct userdetails_base_url (without context /userdetails)
userdetails_base_url = <%= LA_urls_prefix %><%= LA_cas_url %>/userdetails
facets_cached=species_group,species_subgroup,state,country,institution_uid,collection_uid,data_resource_uid

<%_ if (LA_use_data_quality) { _%>
data_quality_enabled = <% if (typeof LA_enable_data_quality != 'undefined') { %><%- LA_enable_data_quality %><% } else { %><%- true %><%_ } %>
data_quality_url = <%= LA_urls_prefix %><%= LA_data_quality_url %><%= LA_data_quality_path %>/
data_quality_learnmore_link = https://support.ala.org.au/support/solutions/articles/6000240256-getting-started-with-the-data-quality-filters
data_quality_warning_on = true
# data_quality_default_disable_all_filters = false
# data_quality_default_expand_filters = true
dataQualitydata_quality_checks_url=https://raw.githubusercontent.com/AtlasOfLivingAustralia/ala-install/master/ansible/roles/biocache-hub/files/data-quality-checks-with-pipelines.csv
# skin_data_quality_link_show = false
# skin_data_quality_link_url = "https://biocache-dq-test.ala.org.au"
# skin_data_quality_link_text = "Try the new search interface with automatic filtering based on data quality metrics"
<%_ } _%>

[biocache-service-clusterdb:vars]

solr_downloadquery_maxthreads=1
endemic_query_maxthreads=1
online_downloadquery_maxthreads=2
download_offline_parallelquery_maxthreads=30
download_offline_max_size=50000000
download_throttle_ms=600
download_batch_size=1000
download_internal_queue_size=2000
download.shp.enabled=false
scatterplot_query_page_size=20000
facets_max = 32
qid_wkt_maxPoints=10000
# 100 * 1024 * 1024
wms_cache_size_max=104857600
# When https://github.com/AtlasOfLivingAustralia/biocache-service/issues/247 is fixed set to true
content_type_options_header=false
<%_ if (LA_use_data_quality) { _%>
data_quality_enabled = <% if (typeof LA_enable_data_quality != 'undefined') { %><%- LA_enable_data_quality %><% } else { %><%- true %><%_ } %>
data_quality_url = <%= LA_urls_prefix %><%= LA_data_quality_url %><%= LA_data_quality_path %>/
<%_ } _%>

[biocache-cli:vars]

# This is different that the rest so media.url is generated correctly
biocache_service_base_url = <%= LA_urls_prefix %><%= LA_biocache_service_url %><%= LA_biocache_service_path %>

<%_ if (LA_use_species) { _%>
[bie-hub:vars]

bie_skin_layout = ala
# this can fail if you install bie with other services, so commented for now
# nginx_cors_origin_regexp = ^https?:\/\/(localhost|<%- LA_domain.replace(/\./g, '\\.') %>|.*\.<%- LA_domain.replace(/\./g, '\\.') %>)

# A list sources that should not have articles fetched from an external site. This is usually because the article is subject to controversy or is not correct (separator: |)
# blacklist_source="https?://www\\\\.example\\\\.com/.*|https?://example\\\\.com/.*"
blacklist_source =

[bie-index:vars]

bie_index_skin_layout = main
<%_ } _%>

<%_ if (LA_use_images) { _%>
[image-service:vars]
image_skin_layout = main
image_service_whitelist = <% if (typeof LA_server_ips != 'undefined') { %><%- LA_server_ips %><% } else { %><%_ } %>
<%_ } _%>

<%_ if (LA_use_species_lists) { _%>
[species-list:vars]

specieslist_skin_layout = main
set_sql_mode = true
skin_fluid_layout = true
<%_ } _%>

<% if (LA_use_regions) { %>
[regions:vars]

# Regions use biocache_service_base_url instead of biocache_service_url
biocache_service_base_url = <%= LA_urls_prefix %><%= LA_biocache_service_url %><%= LA_biocache_service_path %>

regions_skin_layout = main

# Whe https://github.com/AtlasOfLivingAustralia/regions/issues/63 is fixed set to true
content_type_options_header=false

<%_ } _%>
<%_ if (LA_use_alerts) { _%>
[alerts-service:vars]

alerts_skin_layout = main
skin_layout = main
# This userdetails_url and context is different in alerts from the rest of tools
userdetails_url = <%= LA_urls_prefix %><%= LA_cas_url %>/userdetails
userdetails_context_path = /userdetails

bie_search_path=/search
<%_ } _%>

[logger-service:vars]

logger_skin_layout = main

# When https://github.com/AtlasOfLivingAustralia/logger-service/issues/19 is fixed set to true
content_type_options_header=false

# Create a new log format
nginx_other_log_formats=["postdata '$request_body'"]
# Use the new log format to log postdata
logger_service_extra_postdata_logging="access_log  /var/log/nginx/postdata.log  postdata"

<%_ if (LA_use_doi) { _%>
[doi-service:vars]

# production, test, dev
deployment_env = test
doi_service_hostname = <%= LA_doi_url %>
doi_service_base_url = <%= LA_urls_prefix %><%= LA_doi_url %>
doi_service_context_path = <%= LA_doi_path %>
doi_service_port = 8081

doi_service_la_provider_name = ALA
# Types: DATACITE, ANDS
doi_service_default_provider = DATACITE

doi_datacite_api_url = https://api.test.datacite.org/
doi_datacite_user = some_user
doi_datacite_password = some_password
doi_datacite_prefix = "10.5438"
doi_datacite_shoulder = "0012"

ands_doi_mint_url = https://services.ands.org.au/doi/1.1/
ands_doi_app_id =
ands_doi_key =
ands_doi_client_id =

doi_skin_layout = ala-main

# Types: LOCAL, SWIFT, S3
doi_storage_provider = LOCAL
doi_aws_region =
doi_aws_s3_access_key =
doi_aws_s3_secret_key =
doi_aws_s3_bucket =
doi_file_store = /data/doi-service/files
doi_db_hostname = localhost
doi_db_name = doi
doi_db_user = doi
nginx_client_max_body_size = 4096m

<%_ } else { _%>
doi_service_url = https://doi.ala.org.au
<%_ } _%>

<%_ if (LA_use_dashboard) { _%>
[dashboard:vars]
collectory_base_url = <%= LA_urls_prefix %><%= LA_collectory_url %><%= LA_collectory_path %>
biocache_base_url = <%= LA_urls_prefix %><%= LA_biocache_service_url %><%= LA_biocache_service_path %>
biocache_web_base_url = <%= LA_urls_prefix %><%= LA_ala_hub_url %><%= LA_ala_hub_path %>
bie_web_base_url = <%= LA_urls_prefix %><%= LA_ala_bie_url %><%= LA_ala_bie_path %>
# this is url is different in other services (or has a different name)
dashboard_userdetails_base_url = <%= LA_urls_prefix %><%= LA_cas_url %>/userdetails
dashboard_bie_base_url = <%= LA_urls_prefix %><%= LA_bie_index_url %><%= LA_bie_index_path %>
dashboard_spatial_base_url = <%= LA_urls_prefix %><%= LA_spatial_url %>/ws
images_base_url = <%= LA_urls_prefix %><%= LA_images_url %><%= LA_images_path %>
# This is specific of ALA/Australia
useVolunteerService=false
useCitizenScienceService=false
useBarcodeOfLifeService=false
useNationalSpeciesListsService=false
useBHLService=false
<%_ } else { _%>
<%_ } _%>

<%_ if (LA_use_sds) { _%>
[sds:vars]
####### SDS #######
sds_hostname = <%= LA_sds_url %>
sds_base_url = <%= LA_urls_prefix %><%= LA_sds_url %>
sds_url = <%= LA_urls_prefix %><%= LA_sds_url %><%= LA_sds_path %>
sds_context_path = <%= LA_sds_path %>
<%_ } else { _%>
<%_ } _%>

<%_ if (typeof LA_use_biocollect != 'undefined' && LA_use_biocollect) { _%>
[biocollect:vars]
####### BIOCOLLECT #######
biocollect_hostname = <%= LA_biocollect_url %>
biocollect_base_url = <%= LA_urls_prefix %><%= LA_biocollect_url %>
biocollect_url = <%= LA_urls_prefix %><%= LA_biocollect_url %><%= LA_biocollect_path %>
biocollect_context_path = <%= LA_biocollect_path %>
biocollect_homepage_url=https://www.ala.org.au/biocollect
biocollect_rewrite_root=True
images_base_url = <%= LA_urls_prefix %><%= LA_images_url %><%= LA_images_path %>
ecodata_base_url=https://ecodata.ala.org.au
ala_baseURL = <%= LA_urls_prefix %><%= LA_domain %>
merit_base_url=https://fieldcapture.ala.org.au
biocollect_support_email=support@<%= LA_domain %>
mdba_base_url=https://mdba.ala.org.au
deployment_env=prod
<%_ } else { _%>
<%_ } _%>

<%_ if (LA_use_CAS) { _%>
[cas-servers]

<%= LA_cas_hostname %>

###### CAS

[cas-servers:vars]

cas_server_name=<%= LA_urls_prefix %><%= LA_cas_url %>
cas_host_name=<%= LA_cas_url %>
cas_hostname=<%= LA_cas_url %>
cas_url=<%= LA_urls_prefix %><%= LA_cas_url %>/cas
cas_base_url=<%= LA_urls_prefix %><%= LA_cas_url %>
cas_context_path=cas
ala_cas_ui_version=3
cas_cors_enabled=true
# For those intersted in generate different size favicons for CAS:
# https://github.com/AtlasOfLivingAustralia/ala-cas-5/blob/master/src/main/resources/templates/layout.html
skin_favicon_baseurl=<%= LA_urls_prefix %><%= LA_domain %>/favicon/

cas_management_server_name=<%= LA_urls_prefix %><%= LA_cas_url %>

pac4j_cookie_signing_key=<% if (typeof LA_variable_pac4j_cookie_signing_key != 'undefined') { %><%- LA_variable_pac4j_cookie_signing_key %><% } else { %><% } %>
pac4j_cookie_encryption_key=<% if (typeof LA_variable_pac4j_cookie_encryption_key != 'undefined') { %><%- LA_variable_pac4j_cookie_encryption_key %><% } else { %><% } %>
cas_webflow_signing_key=<% if (typeof LA_variable_cas_webflow_signing_key != 'undefined') { %><%- LA_variable_cas_webflow_signing_key %><% } else { %><% } %>
cas_webflow_encryption_key=<% if (typeof LA_variable_cas_webflow_encryption_key != 'undefined') { %><%- LA_variable_cas_webflow_encryption_key %><% } else { %><% } %>

user_create_password=to_be_added_in_the_near_future
endpoints_enabled=true
user_store_db_name=emmet
user_store_db_hostname=localhost
user_store_db_username=userstore
ticket_registry_db_name=casTicketRegistry
ticket_registry_db_hostname=localhost
ticket_registry_db_username=ticket
user_store_db_encoding_salt=salt
user_store_db_encoding_algorithm=MD5
support_email=support@<%= LA_domain %>

cas_audit_ssl_enabled=false
cas_audit_host=localhost
cas_audit_port=27017
cas_audit_db=cas-audit-repository
cas_audit_auth_db=
cas_audit_username=casprod
cas_audit_timeout=PT10S

auth_cookie_domain=<%= LA_domain %>
auth_cookie_secure=false
# Don't change the cookie name, is only used for configuring CAS
# and is a static string (ALA_AUTH_COOKIE) in the rest of ALA,
# so don't change it...
# auth_cookie_name=ALA-Auth

pac4j_callback_url=<%= LA_urls_prefix %><%= LA_cas_url %>/cas/login

userdetails_server_name=<%= LA_urls_prefix %><%= LA_cas_url %>
userdetails_hostname=<%= LA_cas_url %>
userdetails_url=<%= LA_urls_prefix %><%= LA_cas_url %>/userdetails
userdetails_base_url=<%= LA_urls_prefix %><%= LA_cas_url %>
userdetails_context_path=userdetails
userdetails_authorize_ip_list=<% if (typeof LA_server_ips != 'undefined') { %><%- LA_server_ips %><% } else { %><%_ } %>

user_store_db_name=emmet
user_store_db_hostname=localhost
user_store_db_username=userstore

apikey_server_name=<%= LA_urls_prefix %><%= LA_cas_url %>
apikey_hostname=<%= LA_cas_url %>
apikey_context_path=apikey
apikey_base_url=<%= LA_urls_prefix %><%= LA_cas_url %>
apikey_url=<%= LA_urls_prefix %><%= LA_cas_url %>/apikey

apikey_db_name=apikey
apikey_db_username=apikey
apikey_db_hostname=localhost
apikey_db_port=3306

oauth_providers_flickr_key=somekey
oauth_providers_flickr_secret=somesecret

sightings_base_url=
volunteer_base_url=

bootadmin_enabled=false
bootadmin_username=admin23

# This role do not install redis, so none right now
# spring_session_store_type=redis
spring_session_store_type=none

cas_db_migration_baseline=true
apikey_db_migration_baseline=true

server_tz = Europe/Paris

mysql_root_username=root
cas_db_username=cas
cas_db_hostname=localhost
cas_flyway_username=flyway

cas_version=5.3.12-2
cas_management_version=5.3.6-1
user_details_version=2.3.0
apikey_version=1.5

ssl=<%= LA_enable_ssl %>

cas_tickets_host=localhost
cas_tickets_db=cas-ticket-registry
cas_tickets_username=tickets
cas_service_ticket_timeout=15
cas_services_host=localhost
cas_services_db=cas-service-registry
cas_services_username=services
cas_services_timeout=PT10S

mongodb_root_username=admin

# use bs container or container-fluid (leave empty to use non fluid)
skin_fluid_layout = true

userdetails_skin_layout = ala-main
apikey_skin_layout = ala-main

#### END of CAS section
<%_ } else { _%>
<%_ } _%>

<%_ if (LA_use_spatial) { _%>
[spatial]
<%= LA_spatial_hostname %>

[geoserver]
<%= LA_spatial_hostname %>

[geonetwork]
<%= LA_spatial_hostname %>

[spatial-hub]
<%= LA_spatial_hostname %>

[spatial-service]
<%= LA_spatial_hostname %>

###
# Geoserver
###

[geoserver:vars]
is_vagrant=false
local_repo_dir=~/.ala
data_dir=/data

geoserver_hostname=<%= LA_spatial_url %>
geoserver_url=<%= LA_urls_prefix %><%= LA_spatial_url %>/geoserver
geoserver_base_url=<%= LA_urls_prefix %><%= LA_spatial_url %>
geoserver_context_path=/geoserver
geoserver_app=geoserver

geoserver_username=admin

layers_db_host=localhost
layers_db_port=5432
layers_db_name=layersdb
layers_db_username=postgres

postgresql_host=localhost
postgresql_port=5432
postgresql_database=layersdb
postgresql_username=postgres

webserver_nginx=true
nginx_default_vhost_required=true
robots_disallow_paths=["/ws", "/geoserver", "/geonetwork", "/alaspatial", "/files", "/layers-service", "/actions"]
robots_disallow_useragents=["SemrushBot", "Semrush", "SEMrush", "semrush", "Mappy", "BUbiNG"]

ssl=<%= LA_enable_ssl %>

###
# Geonetwork
###

[geonetwork:vars]
data_dir=/data

geonetwork_hostname=<%= LA_spatial_url %>
geonetwork_url=<%= LA_urls_prefix %><%= LA_spatial_url %>/geonetwork
geonetwork_base_url=<%= LA_urls_prefix %><%= LA_spatial_url %>
geonetwork_context_path=/geonetwork
geonetwork_app=geonetwork

geonetwork_host=localhost
geonetwork_port=5432
geonetwork_username=admin
geonetwork_database=geonetwork
geonetwork_db_username=postgres

layers_db_host=localhost
layers_db_port=5432
layers_db_name=layersdb
layers_db_username=postgres

postgresql_host=localhost
postgresql_port=5432
postgresql_database=layersdb
postgresql_username=postgres

webserver_nginx=true

nginx_default_vhost_required=true

robots_disallow_paths=["/ws", "/geoserver", "/geonetwork", "/alaspatial", "/files", "/layers-service", "/actions"]
robots_disallow_useragents=["SemrushBot", "Semrush", "SEMrush", "semrush", "Mappy", "BUbiNG"]

ssl=<%= LA_enable_ssl %>

###
# Spatial service
###

[spatial-service:vars]
data_dir=/data

orgNameLong = <%= LA_project_name %>
orgNameShort = <%= LA_project_shortname %>

spatial_service_hostname=<%= LA_spatial_url %>
spatial_service_url=<%= LA_urls_prefix %><%= LA_spatial_url %>/ws
spatial_service_base_url=<%= LA_urls_prefix %><%= LA_spatial_url %>
spatial_service_context_path=/ws

layers_service_url=<%= LA_urls_prefix %><%= LA_spatial_url %>/ws
biocache_service_url=<%= LA_urls_prefix %><%= LA_biocache_service_url %><%= LA_biocache_service_path %>

layers_db_host=localhost
layers_db_port=5432
layers_db_name=layersdb
layers_db_username=postgres

postgresql_host=localhost
postgresql_port=5432
postgresql_database=layersdb
postgresql_username=postgres

slave_enable=true
service_enable=true

spatial_service_remote_url=https://nectar-spatial-staging.ala.org.au/spatial-service

auth_base_url = https://<%= LA_cas_url %>
auth_cas_url = https://<%= LA_cas_url %>/cas

webserver_nginx=true
nginx_default_vhost_required=true

robots_disallow_paths=["/ws", "/geoserver", "/geonetwork", "/alaspatial", "/files", "/layers-service", "/actions"]
robots_disallow_useragents=["SemrushBot", "Semrush", "SEMrush", "semrush", "Mappy", "BUbiNG"]

ssl=<%= LA_enable_ssl %>

###
# Spatial hub
###

[spatial-hub:vars]
data_dir=/data

startup_lat = <% if (typeof LA_spatial_map_lan != 'undefined') { %><%- LA_spatial_map_lan %><% } else { %>16.942<%_ } %>
startup_lng = <% if (typeof LA_spatial_map_lng != 'undefined') { %><%- LA_spatial_map_lng %><% } else { %>1.261<%_ } %>
startup_zoom = 2

spatial_hub_skin_layout=portal
spatial_hub_hostname=<%= LA_spatial_url %>
spatial_hub_url=<%= LA_urls_prefix %><%= LA_spatial_url %>/
spatial_hub_base_url=<%= LA_urls_prefix %><%= LA_spatial_url %>
spatial_hub_context_path=/
world_outline_base_layer=<%= LA_urls_prefix %><%= LA_spatial_url %>/geoserver/wms?

# Your node default spatial area (by default Australia)
spatial_default_area_name = '<% if (typeof LA_variable_map_zone_name != 'undefined') { %><%- LA_variable_map_zone_name %><% } else { %>Australia<%_ } %>'
spatial_default_area_sqkm = <% if (typeof LA_spatial_map_areaSqKm != 'undefined') { %><%- LA_spatial_map_areaSqKm %><% } else { %>4491002.4759<%_ } %>
spatial_default_area_bbox = <% if (typeof LA_spatial_map_bbox != 'undefined') { %><%- LA_spatial_map_bbox %><% } else { %>[-19.556, 26.588, 5.493, 44.434]<%_ } %>

layers_service_url=<%= LA_urls_prefix %><%= LA_spatial_url %>/ws
geoserver_url=<%= LA_urls_prefix %><%= LA_spatial_url %>/geoserver

sandbox_url=<%= LA_urls_prefix %>sandbox.<%= LA_domain %>/ala-hub
sandbox_ui_url=<%= LA_urls_prefix %>sandbox.<%= LA_domain %>/datacheck
sandbox_biocache_service_url=<%= LA_urls_prefix %>sandbox.<%= LA_domain %>/biocache-service

tomcat_java_opts = -Xmx4g -Xms4g -Xss256k -Djava.awt.headless=true

webserver_nginx=true

nginx_default_vhost_required=true

robots_disallow_paths=["/ws", "/geoserver", "/geonetwork", "/alaspatial", "/files", "/layers-service", "/actions"]
robots_disallow_useragents=["SemrushBot", "Semrush", "SEMrush", "semrush", "Mappy", "BUbiNG"]

ssl=<%= LA_enable_ssl %>

nginx_client_max_body_size=120m


##
# Other components
##

<%_ if (LA_use_species) { _%>
bie_base_url = <%= LA_urls_prefix %><%= LA_ala_bie_url %><%= LA_ala_bie_path %>
bie_service_base_url = <%= LA_urls_prefix %><%= LA_bie_index_url %><%= LA_bie_index_path %>
<%_ } _%>
collections_url = <%= LA_urls_prefix %><%= LA_collectory_url %><%= LA_collectory_path %>
collectory_url = <%= LA_urls_prefix %><%= LA_collectory_url %><%= LA_collectory_path %>
biocache_url = <%= LA_urls_prefix %><%= LA_ala_hub_url %><%= LA_ala_hub_path %>
biocache_service_url = <%= LA_urls_prefix %><%= LA_biocache_service_url %><%= LA_biocache_service_path %>
sampling_url = <%= LA_urls_prefix %><%= LA_spatial_url %>/ws
ala_base_url = <%= LA_urls_prefix %><%= LA_domain %>
# Warning: in spatial, the app uses userdetais_base_url instead of userdetails_url
# so in the rest of inventories like CAS, we use the correct userdetails_base_url (without context /userdetails)
user_details_base_url = https://<%= LA_cas_url %>/userdetails
logger_base_url = <%= LA_urls_prefix %><%= LA_logger_url %><%= LA_logger_path %>/service
<% if (LA_use_species_lists) { %>lists_url = <%= LA_urls_prefix %><%= LA_lists_url %><%= LA_lists_path %><% } %>
api_key_check_url_template = https://<%= LA_cas_url %>/apikey/ws/check?apikey={0}
<%_ if (typeof LA_use_biocollect != 'undefined' && LA_use_biocollect) { _%>
biocollect_url = <%= LA_urls_prefix %><%= LA_biocollect_url %><%= LA_biocollect_path %>
<%_ } else { _%>
biocollect_url =
<%_ } _%>

#### END of Spatial section
<%_ } else { _%>
<%_ } _%>

<%_ if (LA_use_pipelines) { _%>
[spark:vars]

use_openjdk8 = True
spark_version = 2.4.5
hadoop_version = 2.8.2
spark_working_dir = /data/spark/tmp
spark_master_port = 7077
spark_worker_work_port = 65000
spark_master_ui_port = 8080
spark_worker_ui_port = 8085
spark_download_location = https://archive.apache.org/dist/spark/
spark_user = "spark" # the name of the (OS) user created for spark
spark_master_host = <%= LA_pipelines_master %>
spark_user_groups = [] # Optional list of (OS) groups the new spark user should belong to
spark_user_shell = "/bin/bash" # the spark user's default shell
host_strings = '[<%- LA_groups_and_servers['spark'].map(i => `"${i}"`).join(', ') -%>]'
spark_defaults_extras = { }
# ALA uses 24 cores and 28G, tune this in your local inventories for adjust it
spark_env_extras = { 'SPARK_WORKER_CORES': 4, 'SPARK_WORKER_MEMORY': '8g', 'SPARK_LOCAL_DIRS': '/data/spark-tmp', 'SPARK_WORKER_OPTS': '-Dspark.worker.cleanup.enabled=true -Dspark.worker.cleanup.interval=300 -Dspark.worker.cleanup.appDataTtl=300 -Dspark.network.timeout=180000' }
spark_installation_dir = "/data/spark"
spark_archive = "spark-{{ spark_version }}-bin-without-hadoop.tgz"
spark_download = "{{ spark_download_location }}spark-{{ spark_version }}/{{ spark_archive }}"
spark_num_workers = "{{ (groups['cluster_master']+ groups['cluster_nodes']) |length|int}}"
spark_master_ip = <%= LA_pipelines_master %>
ssh_key_filename = /home/ubuntu/.ssh/<% if (typeof LA_variable_pipelines_ssh_key != 'undefined') { %><%- LA_variable_pipelines_ssh_key %><% } else { %>SOME_PRIV_KEY<% } %>

# Needed for yml inventory compatibility
spark = "{ 'user': '{{spark_user}}', 'master_host': '{{spark_master_host}}', 'master_ip': '{{spark_master_ip}}', 'version': '{{spark_version}}', 'master_port': '{{spark_master_port}}', 'worker_work_port': '{{spark_worker_work_port}}', 'download_location': '{{spark_download_location}}', 'hadoop_version': '{{hadoop_version}}', 'working_dir': '{{ spark_working_dir }}', 'master_ui_port': '{{ spark_master_ui_port }}', 'worker_ui_port': '{{ spark_worker_ui_port }}', 'user_shell': '{{ spark_user_shell }}', 'user_groups': '{{ spark_user_groups }}', 'default_hosts': '[\"0.0.0.0\", \"127.0.0.1\", \"localhost\", <%- LA_groups_and_servers['spark'].map(i => `\\"${i}\\"`).join(', ') -%>]', 'env_extras': {}, 'defaults_extras': {}, 'slaves': [ <%- LA_groups_children['spark']['cluster_nodes'].map(i => `\\"${i}\\"`).join(', ') -%>] }"
# default_hosts are used to add entries into .ssh/known_hosts

#### END of spark section

[hadoop:vars]

hadoop_version = 2.8.2
hadoop_download_location = https://archive.apache.org/dist/hadoop/common/
hadoop_archive = hadoop-2.8.2.tar.gz
hadoop_data_dir = /data/hdfs/data
hadoop_name_dir = /data/hdfs/name
hadoop_temp_dir = /data/hdfs/tmp
hadoop_user = hdfs
hadoop_user_shell = /bin/bash
hadoop_install_dir = /data/hadoop
ssh_key_filename = /home/ubuntu/.ssh/<% if (typeof LA_variable_pipelines_ssh_key != 'undefined') { %><%- LA_variable_pipelines_ssh_key %><% } else { %>SOME_PRIV_KEY<% } %>
hadoop_master_ip = <%= LA_pipelines_master %>
hadoop_secondary_name_node = <%= LA_pipelines_master %>
hadoop_install_temp_dir = "/data/hadoop-tmp"
# FIXME
hdfs_replication_factor = 3
number_of_nodes = <%- LA_groups_and_servers['hadoop'].length %>
# Needed for yml inventory compatibility
hadoop = "{'data_dir': '{{hadoop_data_dir}}', 'download_location': '{{hadoop_download_location}}', 'hadoop_archive': '{{hadoop_archive}}', 'name_dir': '{{hadoop_name_dir}}', 'secondary_name_node': '{{hadoop_secondary_name_node}}', 'temp_dir': '{{hadoop_temp_dir}}', 'user': '{{hadoop_user}}', 'user_shell': '{{hadoop_user_shell}}', 'version': '{{hadoop_version}}', 'tmp.dir': '{{hadoop_temp_dir}}', 'slaves': [ <%- LA_groups_children['spark']['cluster_nodes'].map(i => `\\"${i}\\"`).join(', ') -%>], 'default_hosts': '[\"0.0.0.0\", \"127.0.0.1\", \"localhost\", <%- LA_groups_and_servers['hadoop'].map(i => `\\"${i}\\"`).join(', ') -%>]' }"
# default_hosts are used to add entries into .ssh/known_hosts

#### END of hadoop section

[pipelines:vars]

data_dir = /data
hadoop_install_dir = /data/hadoop
pipelines_data_dir = /pipelines-data
hadoop_master = <%= LA_pipelines_master %>
hadoop_port = 9000
spark_master = <%= LA_pipelines_master %>
spark_user = spark
spark_tmp = /data/spark-tmp
dwca_tmp = /data/dwca-tmp
dwca_import_dir = /dwca-exports
jenkins_http_port = 9194
docker_dir = /data/docker
include_sampling = <%= LA_use_spatial %>
include_jackknife = false
include_clustering = true
check_solr = true
# FIXME
solr_num_of_partitions = 3
zk_host=<%- LA_groups_and_servers['zookeeper'] != null ? LA_groups_and_servers['zookeeper'].map(i => `${i}:2181`).join(','): 'PIPELINES_NEEDS_A_SOLRCLOUR_AND_ZOOKEEPER_CLUSTER' %>
collectory_url = <%= LA_urls_prefix %><%= LA_collectory_url %><%= LA_collectory_path %>/ws/
image_service_url = <%= LA_urls_prefix %><%= LA_images_url %><%= LA_images_path %>
vocabulary_dir = /pipelines-vocabularies
use_yq_via_ppa = true
# Use debian packages instead of docker as they are more configurable
use_docker_with_pipelines = false
# GBIF Taxonomy Backbone
ala_namemaching_service_source = https://datos.gbif.es/others/nameindex-gbif-backbone-2021-11-26-lucene-8.tgz
ala_namemaching_service_source_sha1 = 7d75896c9512296ebe977ee46a20f4b37d60ea5e
ala_sensitive_data_service_namematching_source = https://datos.gbif.es/others/nameindex-gbif-backbone-2021-11-26-lucene-6.tgz
ala_sensitive_data_service_namematching_sha1 = 74cea2301134411e962ca4857c7ebfce0ff8c9c8
# Spark configuration used by ALA
# Use something like: http://spark-configuration.luminousmen.com/
# to fit your cluster size
interpret_spark_parallelism = 144
interpret_spark_num_executors = 6
interpret_spark_executor_cores = 8
interpret_spark_executor_memory = '24G'
interpret_spark_driver_memory = '4G'
image_sync_spark_parallelism = 144
image_sync_spark_num_executors = 16
image_sync_spark_executor_cores = 8
image_sync_spark_executor_memory = '7G'
image_sync_spark_driver_memory = '1G'
image_load_spark_parallelism = 144
image_load_spark_num_executors = 16
image_load_spark_executor_cores = 8
image_load_spark_executor_memory = '7G'
image_load_spark_driver_memory = '1G'
uuid_spark_parallelism = 500
uuid_spark_num_executors = 6
uuid_spark_executor_cores = 8
uuid_spark_executor_memory = '20G'
uuid_spark_driver_memory = '4G'
sampling_spark_parallelism = 144
sampling_spark_num_executors = 8
sampling_spark_executor_cores = 8
sampling_spark_executor_memory = '16G'
sampling_spark_driver_memory = '4G'
sensitive_spark_num_executors = 8
sensitive_spark_executor_cores = 8
sensitive_spark_executor_memory = '16G'
sensitive_spark_driver_memory = '4G'
index_spark_parallelism = 500
index_spark_num_executors = 6
index_spark_executor_cores = 8
index_spark_executor_memory = '20G'
index_spark_driver_memory = '4G'
jackknife_spark_parallelism = 500
jackknife_spark_num_executors = 24
jackknife_spark_executor_cores = 8
jackknife_spark_executor_memory = '7G'
jackknife_spark_driver_memory = '1G'
clustering_spark_parallelism = 500
clustering_spark_executor_memory = '20G'
clustering_spark_driver_memory = '4G'
solr_spark_parallelism = 500
solr_spark_num_executors = 6
solr_spark_executor_cores = 8
solr_spark_executor_memory = '22G'
solr_spark_driver_memory = '6G'
#### END of pipelines section

<%_ if (LA_use_pipelines_jenkins) { _%>

[jenkins:vars]

jenkins_http_port = 9194

#### END of jenkins section

[pipelines_jenkins:vars]

default_hosts = '["0.0.0.0", "127.0.0.1", "localhost"<%- LA_groups_and_servers['pipelines_jenkins'] != null ? ", " + LA_groups_and_servers['pipelines_jenkins'].map(i => `"${i}"`).join(', '): '' -%>]'
data_dir = /data
ssh_key_filename = /home/ubuntu/.ssh/<% if (typeof LA_variable_pipelines_ssh_key != 'undefined') { %><%- LA_variable_pipelines_ssh_key %><% } else { %>SOME_PRIV_KEY<% } %>
master_node = <%= LA_pipelines_master %>
solr_cluster_node_a = <%- LA_groups_and_servers['solrcloud'] != null ? LA_groups_and_servers['solrcloud'][0]: 'PIPELINES_NEEDS_A_SOLRCLOUR__CLUSTER' %>
solr_cluster_node_b = <%- LA_groups_and_servers['solrcloud'] != null ? LA_groups_and_servers['solrcloud'][0]: 'PIPELINES_NEEDS_A_SOLRCLOUR__CLUSTER' %>
solr_cluster_a_prefix = <%- LA_groups_and_servers['solrcloud'] != null ? LA_groups_and_servers['solrcloud'][0]: 'PIPELINES_NEEDS_A_SOLRCLOUR__CLUSTER' %>
solr_cluster_b_prefix = <%- LA_groups_and_servers['solrcloud'] != null ? LA_groups_and_servers['solrcloud'][0]: 'PIPELINES_NEEDS_A_SOLRCLOUR__CLUSTER' %>
cass_cluster_for_uuid_migration = <%- LA_groups_and_servers['biocache-db'] != null ? LA_groups_and_servers['biocache-db'][0]: 'PIPELINES_NEEDS_A_CASSANDRA_FOR_THIS_JOB' %>

#### END of pipelines_jenkins section
<%_ } _%>

<%_ } else { _%>
<%_ } _%>

<%_ if (LA_use_solrcloud) { _%>
####################### SOLRCLOUD #######################
[zookeeper:vars]
is_vagrant=false
data_dir=/data
use_openjdk11=true
zookeeper_servers=[ <%_ for (i in LA_groups_and_servers['zookeeper']) { _%> { "id": "<%- i -%>", "server_name": "<%- LA_groups_and_servers['zookeeper'][i] -%>" } <%_ } _%>]

[solrcloud:vars]
is_vagrant=false
data_dir=/data
solr_home=/data/solr
# Advertise only on the internal DNS address
solr_port=8983
solr_zk_host=<%- LA_groups_and_servers['zookeeper'] != null ? LA_groups_and_servers['zookeeper'].map(i => `${i}:2181`).join(','): 'PIPELINES_NEEDS_A_SOLRCLOUR_AND_ZOOKEEPER_CLUSTER' %>
solr_environment=prod,label=Production+Cluster+2021,color=orange

solr_repository=https://archive.apache.org/dist/lucene/solr/
solr_version="{{ solrcloud_version }}"
use_openjdk11=true
solr_jmx_port=10058
solr_zk_client_timeout=30000
solr_clustering_enabled=false
jts_use_1_16=true
# Access to solr using both localhost and the solr_host is necessary for our cloud setup
# Access can be restricted to the minimum number of servers necessary using (for instance,
# AWS Security Groups)
solr_bind_jetty_host=false
<%_ } _%>

<%_ if (LA_use_data_quality) { _%>
[data_quality_filter_service:vars]

data_quality_filter_service = data-quality-filter-service

data_quality_filter_service_url = <%= LA_urls_prefix %><%= LA_data_quality_url %><%= LA_data_quality_path %>
data_quality_filter_service_base_url = <%= LA_urls_prefix %><%= LA_data_quality_url %>
data_quality_filter_service_context_path = <%= LA_data_quality_path %>
data_quality_filter_service_hostname = <%= LA_data_quality_url %>

data_quality_filter_service_uri_filter_pattern=/data-profiles,/filters/*,/download.*

# default_list_view =
data_quality_skin_layout = ala
dwc_exclude=dataHubUid,dataProviderUid,institutionUid,year,month,day,modified,left,right,provenance,taxonID,preferredFlag,outlierForLayers,speciesGroups,associatedMedia,images,userQualityAssertion,speciesHabitats,duplicationType,taxonomicIssues,subspeciesID,nameMatchMetric,sounds,verbatimAssociatedMedia

images_metadata_url=<%= LA_urls_prefix %><%= LA_images_url %><%= LA_images_path %>/image/details?imageId=

dq_db_user=data-quality
dq_db_name=data-quality
dq_db_url=jdbc:postgresql://localhost/data-quality
dq_db_dialect=org.hibernate.dialect.PostgreSQLDialect
dq_db_driver=org.postgresql.Driver
# FIXME just testing ALA uses pg 13
data_quality_pg_version=10

# Hardcode the current version as it the stable one
data_quality_filter_service_version = 1.0.0

<%_ } _%>

<%_ if (LA_use_namematching_service) { _%>
[namematching-service:vars]
namematching_service_hostname = <%= LA_namematching_service_url %>
namematching_service_context_path= <%= LA_namematching_service_path %>

# ALA uses 8080 and 8081
namematching_service_port = 8880
namematching_admin_port = 8881

# In ALA:
# nameindex_to_use=ala
# nameindex_datestamp=20200214
# ala_nameindex_source_url=https://archives.ala.org.au/archives/nameindexes

nameindex_user=namematching-service

# FIXME, how to set this without affect other services (as auth do)
# max_memory=512m
# min_memory=512m


<%_ } _%>
