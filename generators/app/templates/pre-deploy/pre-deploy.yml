- name: Pre-deploy preparation tasks
  hosts: all
  gather_facts: False
  tasks:
  - name: install python minimal
    raw: sudo bash -c "test -e /usr/bin/python || (apt -qqy update && apt-get install -qy python3-minimal 'python2.*-minimal')"

- name: Pre-deploy tasks
  hosts: all
  roles:
<% if (typeof LA_etc_hosts != 'undefined') { %>
    - { role: ypsman.hosts, tags: ["pre-task-etc-hosts"]}
<% } %>
    - { role: weareinteractive.sudo, tags: ["pre-task-sudo"] }
    - pre_deploy
  become: yes

- name: Pre-deploy solr tasks
  hosts: solr7-server
  roles:
    - solr_pre_deploy
  become: yes
